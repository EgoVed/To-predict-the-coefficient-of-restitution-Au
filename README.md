# To-predict-the-coefficient-of-restitution-Au
Предсказать коэффициент восстановления золота из золотосодержащей руды

## Технологический процесс

Как золото получают из руды?
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

![Alt text](viruchka_1576238830.jpg)

Опишем каждую стадию:

### 1. Флотация

Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

### 2. Очистка

Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

### Описание данных

### Технологический процесс

#### Rougher feed — исходное сырье
#### Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
#### Xanthate **— ксантогенат (промотер, или активатор флотации);
#### Sulphate — сульфат (на данном производстве сульфид натрия);
#### Depressant — депрессант (силикат натрия).
#### Rougher process (англ. «грубый процесс») — флотация
#### Rougher tails — отвальные хвосты
#### Float banks — флотационная установка
#### Cleaner process — очистка
#### Rougher Au — черновой концентрат золота
#### Final Au — финальный концентрат золота

### Параметры этапов
#### air amount — объём воздуха
#### fluid levels — уровень жидкости
#### feed size — размер гранул сырья
#### feed rate — скорость подачи

### Наименование признаков

#### Наименование признаков должно быть такое:
[этап].[тип_параметра].[название_параметра]

Пример: rougher.input.feed_ag

### Возможные значения для блока [этап]:

#### rougher — флотация
#### primary_cleaner — первичная очистка
#### secondary_cleaner — вторичная очистка
#### final — финальные характеристики

### Возможные значения для блока [тип_параметра]:
#### input — параметры сырья
#### output — параметры продукта
#### state — параметры, характеризующие текущее состояние этапа
#### calculation — расчётные характеристики

### Расчёт эффективности

Вам нужно смоделировать процесс восстановления золота из золотосодержащей руды.
Эффективность обогащения рассчитывается по формуле

![Alt text](_smape_1576239054.jpg)

где:
C — доля золота в концентрате после флотации/очистки;
F — доля золота в сырье/концентрате до флотации/очистки;
T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

### Метрика качества
Для решения задачи введём новую метрику качества — sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).
Она похожа на MAE, но выражается не в абсолютных величинах, а в относительных. Почему симметричная? Она одинаково учитывает масштаб и целевого признака, и предсказания.
Метрика sMAPE вычисляется так:

![Alt text](smape_1576239058.jpg)

## Данные находятся в трёх файлах:

### gold_recovery_train.csv — обучающая выборка;
### gold_recovery_test.csv — тестовая выборка;
### gold_recovery_full.csv — исходные данные.

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке
отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.
В распоряжении сырые данные: их просто выгрузили из хранилища. 

Инструкция по выполнению проекта
1. Подготовить данные
1.1. Проверяю, что эффективность обогащения рассчитана правильно. Вычисляю её на обучающей выборке для признака 
rougher.output.recovery. Нахожу MAE между моими расчётами и значением признака.Выводы.
1.2. Предобработка данных.
2. Анализ данных
2.1. Смотрю, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки. Выводы.
2.2. Сравниваю распределения размеров гранул сырья на обучающей и тестовой выборках.
2.3. Исследую суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах. 
3. Построение модели
3.1. Функцию для вычисления итоговой sMAPE.
3.2. Обучение разных модели и оценка их качество кросс-валидацией. Выбор лучшей модели и проверка её на тестовой выборке. 
4. Выводы
